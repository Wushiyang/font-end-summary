# 正则表达式和模式匹配

### 正则表达式的定义

#### 正则创建

```javascript
//直接量
const r = /[Jj]ava[Ss]cript$/;
//构造函数
const r = new RegExp('[Jj]ava[Ss]cript$');
```

ES3规定同一段代码表示正则表达式直接量每次运行都返回同一个对象

ES5规定同一段代码表示正则表达式直接量每次运行都返回新对象

#### 正则语法

##### 直接量字符

使用字符串的转移字符和直接量字符

```javascript
unicode字符
\t	制表符(\u0009)
\n	换行符(\u000a)
\v	垂直制表符(\u000b)
\f	换页符(\u000c)
\r	回车符(\u000d)
\xnn	由十六进制数nn指定的拉丁字符
\uxxxx	由十六进制数xxxx指定的unicode字符
\cX	控制字符^X,例如\cJ等于\n
```

##### 字符类

```
[...]	方括号内任意字符
[^...]	不再方括号内的任意字符
.	除换行符和其他Unicode行终止符之外的任意字符
\w	[a-zA-Z0-9_]
\W	[^a-zA-Z0-9_]
\s	任何Unicode空白符
\S	任何非Unicode空白符的字符
\d	[0-9]
\D	[^0-9]
[\b]	退格直接量
```

##### 量词

```
{n,m}	匹配n次到m次
{n,}	匹配n次以上
{n}	正好匹配n次
?	{0,1},??非贪婪
+	{1,},+?非贪婪
*	{0,},*?非贪婪
```

正则默认是<首字符开始的><贪婪匹配>，首字符匹配就是从符合匹配的匹配项开始不会略过符合的字符，贪婪匹配就是尽可能多的匹配。

非贪婪匹配在量词后加'?'。

/a+?b/匹配aaab时，虽然是非贪婪模式，但遵从<首字符开始的>的规则会匹配aaab。

##### 选择、分组和引用

```
|	选择，从左开始匹配，符合则使用匹配规则，否则匹配右边规则
(...)	组合，将多个项组合为一个单元并记忆
(?:...)	只组合，组合项成一个单元，但不记忆
\n	引用，引用记忆的组合，(?:...)不参与编码
```

##### 位置

```
^	匹配开头
$	匹配结尾
\b	匹配单词边界
\B	匹配飞单词边界
(?=p)	零宽正向先行断言，接下来的字符与p匹配，但p是零宽的（无法取）
(?!p)	零宽负向先行断言，接下来的字符不与p匹配
```

##### 修饰符

```
i	不区分大小写
g	全局匹配
m	多行匹配
```

### String方法

```
string.search(regexp)
string.replace(regexp)
string.match(regexp)
```

### RegExp对象

```javascript
//RegExp对象
const r = new RegExp(pattern, attributes);
//RegExp对象属性
r.source	只读，正则表达式文本
r.global	只读，是否有g修饰符
r.ignoreCase	只读，是否有i修饰符
r.multiline	只读，是否有m修饰符
r.lastIndex	可读写，用于exec()和test(),表示检测字符串的读取位置
//RegExp对象方法
r.test(str);	//返回true或false
r.exec(str);	//返回数组或null，数组第一个元素是匹配字符串，第二个元素是子表达式匹配的字符串，index是匹配位置，input引用正检索的字符串。
```